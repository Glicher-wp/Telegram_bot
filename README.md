# Telegram_bot
 Simple telegram bot for Yandex.Tracker
 
 ## Описание проекта
 
Простенький телеграм бот для получения обновлений с аккауна Яндекс.Трекера. Бот принимает email пользователя Яндекс.Трекера и возвращает ему список текущих задач, после чего предлагает каждые 20 минут получать собщения об обновленных задачах, если таковые появляются. 

## Как пользоваться
Для командного взаимодействия с ботом используются команды: `/start`, `/status`, `/cancel`. Которые запускают работу бота, возвращают всю статистику по задачам, и завершают работу бота, соответственно. Остальные данные бот получает из текстовых сообщений.

## Как установить
Для начала устанавливаме сам код. Для этого в командной строке, в нужной нам папки вводим `git clone https://github.com/Glicher-wp/Telegram_bot.git`. Предварительно убедитесь, что у вас установлен гит. после этого, создаем виртуальное окружение и вводим команду `pip install -r rquirements.txt`. После чег будут установлены все необходимые библиотеки.
Дальше нам нужно получить необходимые для работы **токены**

### Получение токена Telegram
Здесь все просто, идем в наш Telegram (предварительно не забыв его установить) и находим там **@BotFather**. 
![куда-то делось изображение](https://png.cmtt.space/paper-media/24/a0/9c/1b28d2e0b91a8e.png)

Далее следуем его инстркциям и получаем от него **токен** для своего бота. Подставляем его в `TELEGRAM_TOKEN = os.environ.get("TELEGRAM_TOKEN")`. С этим все готово.

### Получение токена Яндекс.Трекер

Здесь чуть сложнее. Для начала, нам нужно приложениее Трекера. Если оно есть - отлично, если нет [идем сюда](https://tracker.yandex.ru/hi-there?origin=tracker&source=tracker_promo) и создаем организацию. Яндекс автоматически создаст для вас трекер. Дальше идем к плашке **Очереди** в верхней части страницы и смотрим там поле ORG 
![здесь должно быть фото](https://sun9-58.userapi.com/impf/ij7sGQ7Ue1zoH1Hd9SSsT7JNLgvUaRNgGLbwzQ/H3HwPj1klCo.jpg?size=944x656&quality=96&proxy=1&sign=53bc9fe24a04bff396a12ca94c74c96a&type=album)
Нас интересут числовой индекс - это наш **ORG_ID**.
Дальше идем на [страницу авторизации](https://oauth.yandex.ru/) за **токеном**. И создаем там приложение, либо выбераем нужное, если оно уже есть. Здесь вводим любое название и описание (их всегда можно будет поменять). Далее в поле **Платформы** выбираем **веб сервисы** и нажимаем на ссылку **подставить URL**, чтобы получить дефолтный callback URL.
![здесь должно быть фото](https://sun9-26.userapi.com/impf/vTj0_ThnieeqiYjXVgJpc6PB-JEta9pGQ0AOsA/BcUG9TutynQ.jpg?size=1018x450&quality=96&proxy=1&sign=a1542b085cf78b5732aa0bd1ec6e1ec7&type=album)
В поле **Доступы** выбираем **Трекер** и даем ему все разрешения(шоб было)
![здесь должно быть фото](https://sun9-13.userapi.com/impf/wJpHVbSXvhbgrngBBcpul67amu-Acz4JK7In6g/tAkLWkP1CAs.jpg?size=1130x920&quality=96&proxy=1&sign=0db69a717d3a530cabe83bc2400271a9&type=album)
Дальше возвращаемся на свою [страницу авторизации](https://oauth.yandex.ru/). Заходим в профиль нашего приложения и копируем его **ID**. Он нам сейчас пригодится.
![здесь должна быть картинка](https://sun9-52.userapi.com/impf/AresAV5cl8UsHZe2qcWfTvVFJFXymDGkDhWkJQ/rK4Orq6mCRo.jpg?size=614x738&quality=96&proxy=1&sign=151574bbb5b59d03396854370ce08758&type=album)

После этого возвращаемся и переходем по ссылке `https://oauth.yandex.ru/authorize?response_type=token&client_id=<идентификатор приложения>` в котору подставляем только что скопированный **ID**. На странце будет нужный там **токен**. 
Подставляем **ORG_ID** и **токен** в переменные `ORG_ID = os.environ.get('ORG_ID')` `YANDEX_TOKEN = os.environ.get('YANDEX_TOKEN')`. Готово,мы подключились к нашей организации в Трекере.

### Получение задач
После этого нам остается только создать очередь, **ключ** которой мы подставим в переменные `queue = client.queues["ключ созданной очереди"]`. Сам ключ находится в адрессной строке, либо его можно увидеть при создании задачи. Он представляет из себя заглавные латинские буквы.

Теперь бот готов. Остается только запустить его: `python telegram_bot_logic.py`
